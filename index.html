
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CAPTAÇÃO DE DADOS</title>
  <style>
    body { font-family: Arial; margin: 40px; }
    form { max-width: 800px; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
    .row { display: flex; gap: 20px; }
    .row > div { flex: 1; }
    .upload-section { margin-top: 20px; }
    .button-group { display: flex; gap: 10px; margin-top: 30px; }
    .save-button, .print-button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
  </style>
</head>
<body>
  <header style="display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px;">
    <div><strong>INATRO.EP</strong></div>
    <div style="text-align: right;">
      <h1 style="margin: 0;">CAPTAÇÃO DE DADOS</h1>
      <svg id="barcode" style="margin-top: 5px;"></svg>
    </div>
  </header>

  <form id="dadosForm">
    <label for="nome">Nome Completo</label>
    <input type="text" id="nome" name="nome" required/>

    <label for="nascimento">Data de Nascimento</label>
    <input type="date" id="nascimento" name="nascimento" required/>

    <label for="tipoDocumento">Tipo de Documento</label>
    <input type="text" id="tipoDocumento" name="tipoDocumento" required/>

    <label for="numeroDocumento">Número do Documento</label>
    <input type="text" id="numeroDocumento" name="numeroDocumento" required/>

    <label for="dataEmissao">Data de Emissão</label>
    <input type="date" id="dataEmissao" name="dataEmissao" required/>

    <div class="row">
      <div>
        <label for="nacionalidade">Nacionalidade</label>
        <input type="text" id="nacionalidade" name="nacionalidade" required/>
      </div>
      <div>
        <label for="natural">Natural</label>
        <input type="text" id="natural" name="natural" required/>
      </div>
    </div>

    <label for="contactos">Contactos</label>
    <input type="text" id="contactos" name="contactos" required/>

    <label for="bairro">Bairro</label>
    <input type="text" id="bairro" name="bairro" required/>

    <label for="classeCarta">Classe de Carta</label>
    <input type="text" id="classeCarta" name="classeCarta" required/>

    <div class="upload-section">
      <label for="foto">Upload de Foto</label>
      <input type="file" id="foto" name="foto" accept="image/*"/>
      <label for="assinatura">Assinatura / Impressão Digital</label>
      <input type="file" id="assinatura" name="assinatura" accept="image/*"/>
    </div>

    <label for="observacao">Observações</label>
    <textarea id="observacao" name="observacao" rows="4"></textarea>

    <div class="button-group">
      <button type="button" class="save-button" onclick="enviarParaServidor()">Enviar</button>
      <button type="button" class="print-button" onclick="window.print()">Imprimir</button>
    </div>
  </form>

  <!-- JsBarcode CDN -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script>
    const numeroDocumentoInput = document.getElementById("numeroDocumento");

    numeroDocumentoInput.addEventListener("input", () => {
      const valor = numeroDocumentoInput.value.trim();
      if (valor.length > 0) {
        JsBarcode("#barcode", valor, {
          format: "CODE128",
          lineColor: "#000",
          width: 2,
          height: 40,
          displayValue: false
        });
      } else {
        document.getElementById("barcode").innerHTML = "";
      }
    });

    async function enviarParaServidor() {
      const form = document.getElementById('dadosForm');
      if (!form.checkValidity()) {
        alert('Preencha todos os campos obrigatórios.');
        return;
      }

      const formData = new FormData(form);
      try {
        const response = await fetch('/submit', {
          method: 'POST',
          body: formData
        });

        if (response.ok) {
          alert('Dados enviados com sucesso!');
        } else {
          alert('Erro ao enviar os dados.');
        }
      } catch (err) {
        console.error('Erro:', err);
        alert('Erro de comunicação com o servidor.');
      }
    }
  </script>
</body>
</html>
